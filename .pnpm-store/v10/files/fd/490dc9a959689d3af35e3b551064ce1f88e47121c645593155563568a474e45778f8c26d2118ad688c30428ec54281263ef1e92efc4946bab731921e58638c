{"version":3,"file":"index.mjs","names":["SOLID_START_DEPENDENCIES: GeneratorDependency[]","getSolidStartDependencies: ClientDependenciesBuilder","generateSolidStartTitle: ClientTitleBuilder","generateSolidStartHeader: ClientHeaderBuilder","generateSolidStartFooter: ClientFooterBuilder","propsImplementation","queryParamsCode","headersToAdd: string[]","generateSolidStart: ClientBuilder","solidStartClientBuilder: ClientGeneratorsBuilder"],"sources":["../src/index.ts"],"sourcesContent":["import {\n  type ClientBuilder,\n  type ClientDependenciesBuilder,\n  type ClientFooterBuilder,\n  type ClientGeneratorsBuilder,\n  type ClientHeaderBuilder,\n  type ClientTitleBuilder,\n  generateBodyOptions,\n  generateFormDataAndUrlEncodedFunction,\n  generateVerbImports,\n  type GeneratorDependency,\n  type GeneratorOptions,\n  type GeneratorVerbOptions,\n  getIsBodyVerb,\n  isObject,\n  pascal,\n  sanitize,\n  toObjectString,\n  Verbs,\n} from '@orval/core';\n\nconst SOLID_START_DEPENDENCIES: GeneratorDependency[] = [\n  {\n    exports: [\n      { name: 'query', values: true },\n      { name: 'action', values: true },\n      { name: 'cache', values: true },\n      { name: 'revalidate', values: true },\n    ],\n    dependency: '@solidjs/router',\n  },\n  {\n    exports: [{ name: 'DeepNonNullable' }],\n    dependency: '@orval/core',\n  },\n];\n\nexport const getSolidStartDependencies: ClientDependenciesBuilder = () =>\n  SOLID_START_DEPENDENCIES;\n\nexport const generateSolidStartTitle: ClientTitleBuilder = (title) => {\n  const sanTitle = sanitize(title);\n  return `${pascal(sanTitle)}`;\n};\n\nexport const generateSolidStartHeader: ClientHeaderBuilder = ({ title }) => `\n/**\n * Cache Invalidation:\n *\n * Each query provides .key and .keyFor() for cache invalidation.\n *\n * Examples:\n *   // Invalidate all calls to a query\n *   revalidate(${title}.listPets.key);\n *\n *   // Invalidate a specific call with arguments\n *   revalidate(${title}.showPetById.keyFor(\"pet-123\", 1));\n *\n *   // Invalidate multiple queries\n *   revalidate([${title}.listPets.key, ${title}.showPetById.keyFor(\"pet-123\", 1)]);\n */\nexport const ${title} = {\n`;\n\nexport const generateSolidStartFooter: ClientFooterBuilder = () => {\n  return '};\\n';\n};\n\nconst generateImplementation = (\n  {\n    headers,\n    queryParams,\n    operationName,\n    response,\n    mutator,\n    body,\n    props,\n    verb,\n    override,\n    formData,\n    formUrlEncoded,\n    paramsSerializer,\n  }: GeneratorVerbOptions,\n  { route, context }: GeneratorOptions,\n) => {\n  const isFormData = !override.formData.disabled;\n  const isFormUrlEncoded = override.formUrlEncoded !== false;\n  const bodyForm = generateFormDataAndUrlEncodedFunction({\n    formData,\n    formUrlEncoded,\n    body,\n    isFormData,\n    isFormUrlEncoded,\n  });\n\n  const dataType = response.definition.success || 'unknown';\n  const isGetVerb = verb === Verbs.GET;\n  const isBodyVerb = getIsBodyVerb(verb);\n\n  if (mutator) {\n    const propsImplementation =\n      mutator.bodyTypeName && body.definition\n        ? toObjectString(props, 'implementation').replace(\n            new RegExp(String.raw`(\\w*):\\s?${body.definition}`),\n            `$1: ${mutator.bodyTypeName}<${body.definition}>`,\n          )\n        : toObjectString(props, 'implementation');\n\n    // Build query params string\n    const queryParamsCode = queryParams\n      ? `const queryString = new URLSearchParams(params as any).toString();\n    const url = queryString ? \\`${route}?\\${queryString}\\` : \\`${route}\\`;`\n      : `const url = \\`${route}\\`;`;\n\n    // Build fetch options using Fetch API signature\n    const fetchMethodOption = `method: '${verb.toUpperCase()}'`;\n    const ignoreContentTypes = ['multipart/form-data'];\n    const overrideHeaders =\n      isObject(override.requestOptions) && override.requestOptions.headers\n        ? Object.entries(override.requestOptions.headers).map(\n            ([key, value]) => `'${key}': \\`${value}\\``,\n          )\n        : [];\n\n    const headersToAdd: string[] = [\n      ...(body.contentType && !ignoreContentTypes.includes(body.contentType)\n        ? [`'Content-Type': '${body.contentType}'`]\n        : []),\n      ...overrideHeaders,\n      ...(headers ? ['...headers'] : []),\n    ];\n\n    const fetchHeadersOption =\n      headersToAdd.length > 0 ? `headers: { ${headersToAdd.join(',')} }` : '';\n\n    const requestBodyParams = generateBodyOptions(\n      body,\n      isFormData,\n      isFormUrlEncoded,\n    );\n    const fetchBodyOption = requestBodyParams\n      ? (isFormData && body.formData) ||\n        (isFormUrlEncoded && body.formUrlEncoded) ||\n        body.contentType === 'text/plain'\n        ? `body: ${requestBodyParams}`\n        : `body: JSON.stringify(${requestBodyParams})`\n      : '';\n\n    const fetchOptions = `{\n      ${fetchMethodOption}${fetchHeadersOption ? ',' : ''}\n      ${fetchHeadersOption}${fetchBodyOption ? ',' : ''}\n      ${fetchBodyOption}\n    }`;\n\n    if (isGetVerb) {\n      // Use query for GET requests\n      return `  ${operationName}: query(async (${propsImplementation}) => {${bodyForm}\n    ${queryParamsCode}\n    return ${mutator.name}<${dataType}>(\n      url,\n      ${fetchOptions}\n    );\n  }, \"${operationName}\"),\n`;\n    } else {\n      // Use action for mutations\n      return `  ${operationName}: action(async (${propsImplementation}) => {${bodyForm}\n    ${queryParamsCode}\n    return ${mutator.name}<${dataType}>(\n      url,\n      ${fetchOptions}\n    );\n  }, \"${operationName}\"),\n`;\n    }\n  }\n\n  const propsImplementation = toObjectString(props, 'implementation');\n\n  // Build query params string\n  const queryParamsCode = queryParams\n    ? `const queryString = new URLSearchParams(params as any).toString();\n    const url = queryString ? \\`${route}?\\${queryString}\\` : \\`${route}\\`;`\n    : `const url = \\`${route}\\`;`;\n\n  // Build headers object\n  const headersCode = headers\n    ? `headers: { ...headers, 'Content-Type': 'application/json' }`\n    : `headers: { 'Content-Type': 'application/json' }`;\n\n  // Build body code\n  const bodyCode =\n    isBodyVerb && body.implementation\n      ? `,\n      body: JSON.stringify(${body.implementation})`\n      : '';\n\n  if (isGetVerb) {\n    // Use query for GET requests\n    return `  ${operationName}: query(async (${propsImplementation}) => {${bodyForm}\n    ${queryParamsCode}\n    const response = await fetch(url, {\n      method: '${verb.toUpperCase()}',\n      ${headersCode}\n    });\n    if (!response.ok) {\n      throw new Error(\\`HTTP error! status: \\${response.status}\\`);\n    }\n    return response.json() as Promise<${dataType}>;\n  }, \"${operationName}\"),\n`;\n  } else {\n    // Use action for mutations (POST, PUT, PATCH, DELETE)\n    return `  ${operationName}: action(async (${propsImplementation}) => {${bodyForm}\n    ${queryParamsCode}\n    const response = await fetch(url, {\n      method: '${verb.toUpperCase()}',\n      ${headersCode}${bodyCode}\n    });\n    if (!response.ok) {\n      throw new Error(\\`HTTP error! status: \\${response.status}\\`);\n    }\n    return response.json() as Promise<${dataType}>;\n  }, \"${operationName}\"),\n`;\n  }\n};\n\nexport const generateSolidStart: ClientBuilder = (verbOptions, options) => {\n  const imports = generateVerbImports(verbOptions);\n  const implementation = generateImplementation(verbOptions, options);\n\n  return { implementation, imports };\n};\n\nconst solidStartClientBuilder: ClientGeneratorsBuilder = {\n  client: generateSolidStart,\n  header: generateSolidStartHeader,\n  dependencies: getSolidStartDependencies,\n  footer: generateSolidStartFooter,\n  title: generateSolidStartTitle,\n};\n\nexport const builder = () => () => solidStartClientBuilder;\n\nexport default builder;\n"],"mappings":"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"}